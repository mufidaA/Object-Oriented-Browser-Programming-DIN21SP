<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <title>Document</title>
    <style>
        .container {
        display: inline-blox;
        grid-gap: 30px;
        margin-left: 25%;
        margin-right: 25%;
        padding: 30px;
        align-content: center;
        }

        .container > div {
        text-align: center;
        padding: 30px 0;
        font-size: 30px;
        }
        
        .btn {
        background-color: black; 
        border: none; 
        color: white;
        padding: 12px 16px; 
        font-size: 16px; 
        cursor: pointer;
        border: 2px solid #4CAF50; 
     }

        .btn:hover {
        color: #4CAF50;
        }
        .nav {
        display: inline-block;
        min-height: fit-content;
        min-width:fit-content;
        position: sticky;
        top: 0;
        margin-left: 90%;

    }
    

    </style>
</head>
<body>
        <div class="nav">
            <button class="btn" onclick="updateHome()"><i class="fa fa-undo fa-fw"></i></button>
            <button class="btn" onclick="showCart()"><i class="fa fa-shopping-cart"></i> (<span id="total-count">0</span>)</button>
            
        </div>
        <div class="container" style="padding-bottom:2000px">
            <div id="column"></div>

       
        </div>
        <div class="cart" visible="false" > </div>


 
</body>
<script> 
    let allObjects;
    let shoppingCart = [];

    function addIdxToCart(itemidx){
      shoppingCart.push(itemidx);
      count = document.getElementById("total-count");
      count.innerHTML = shoppingCart.length;
    }

    function updateHome(){ 
      document.body.scrollTop = 0;
      document.documentElement.scrollTop = 0;
      var element = document.getElementById("column");
      element.innerHTML = "";
      fetch('https://dummyjson.com/products').then(res => res.json()).then(extractData);
    }
    
    function extractData(objects){
      allObjects = objects.products;
      for (var i = 0; i <  10 ; i++) {
          extractProduct(i);
        }
    }
    
    function extractProduct(idx) {
      let product = allObjects[idx];
      let id = product.id;
      var column = document.getElementById("column");
      let div = document.createElement("div");
      column.appendChild(div);
      let newProduct = document.createElement("img");
      newProduct.src = product.images[0];
      div.appendChild(newProduct);
      newProduct.style.height = "300px";
      let productTitle = document.createElement("div");
      productTitle.innerHTML = product.brand +"<br>"  + product.title;
      div.appendChild(productTitle);
      newProduct.addEventListener("click", function(){ productDescription(idx); });
    };
    
    function productDescription(idx) {
        function productDetail(productIdx) {          
          var product = allObjects[productIdx];
          var element = document.getElementById("column");
          element.innerHTML = product.title + "<br>" + product.description + "<br> Price " + product.price + " €" ;
          let div = document.createElement("div");
          element.appendChild(div);
            for (var i = 0; i < product.images.length; i++) {
                newProduct =document.createElement("img");
                newProduct.src = product.images[i];
                div.appendChild(newProduct);
                if ( i < 1 ) {
                newProduct.style.alignContent = "center";
                newProduct.style.display="block";
                }
                else {newProduct.style.display = "inline-block";
                newProduct.style.width = "200px";
            }
            document.body.scrollTop = 0;
            document.documentElement.scrollTop = 0;

            }
          let cartBtn = document.createElement("div");
          div.appendChild(cartBtn);
          addToCart = document.createElement("button") ;
          addToCart.addEventListener("click", function(){ addIdxToCart(idx); });
          addToCart.innerHTML = "Add product to cart";      
          cartBtn.appendChild(addToCart);  
        }
          productDetail(idx);          
        }; 

        function showCart(){
          var element = document.getElementById("column");
          element.innerHTML = "";
          let total = 0 ;
          for(var i = 0; i < shoppingCart.length; i++){
            var product = allObjects[shoppingCart[i]];
            let div = document.createElement("div");
            div.innerHTML = product.title + " " + " - " + product.price + " €";
            div.style.alignContent = "flex-start";
            element.appendChild(div);
            total += parseFloat(product.price);
          }
          let divtotal = document.createElement("div");
          divtotal.innerHTML = "<br>Total price " + total + " € <br>";
          divtotal.style.alignContent = "flex-start";
          element.appendChild(divtotal);
          document.body.scrollTop = 0;
          document.documentElement.scrollTop = 0;
        }

        updateHome();

 </script> 
</html>